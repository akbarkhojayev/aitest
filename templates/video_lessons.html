{% extends 'base.html' %}

{% block title %}Video Darslar{% endblock %}

{% block content %}
<div class="page-header" style="display: flex; justify-content: space-between; align-items: center;">
    <div>
        <h2>ğŸ¥ Video Darslar</h2>
        <p>O'quv videolarini ko'ring va o'rganing</p>
    </div>
    {% if user.userprofile.user_type == 'teacher' %}
    <a href="{% url 'create_video' %}" class="btn btn-success" style="padding: 12px 24px; font-size: 15px;">
        â• Yangi Video Qo'shish
    </a>
    {% endif %}
</div>

{% if user.userprofile.user_type == 'teacher' %}
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 35px;">
    <div class="stats-card">
        <div class="number">{{ videos.count }}</div>
        <div class="label">Jami Videolar</div>
    </div>
</div>
{% endif %}

<h3 style="color: #2c3e50; font-size: 18px; font-weight: 600; margin-bottom: 20px; display: flex; align-items: center; gap: 8px;">
    <span style="width: 4px; height: 24px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 2px;"></span>
    Barcha Video Darslar
</h3>

{% if videos %}
<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 20px;">
    {% for video in videos %}
    <div class="card" style="border-top: 3px solid #e74c3c;">
        <div style="position: relative; border-radius: 8px; overflow: hidden; margin-bottom: 15px; background: #000;">
            {% if video.get_video_id %}
            <a href="{% url 'watch_video' video.id %}" style="display: block; position: relative; text-decoration: none;">
                <img 
                    src="{{ video.get_thumbnail_url }}" 
                    alt="{{ video.title }}"
                    style="width: 100%; height: auto; display: block;"
                    onerror="this.src='https://via.placeholder.com/640x360/667eea/ffffff?text=Video'"
                >
                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(0,0,0,0.7); width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; transition: all 0.3s;">
                    <svg width="30" height="30" viewBox="0 0 24 24" fill="white">
                        <path d="M8 5v14l11-7z"/>
                    </svg>
                </div>
            </a>
            {% else %}
            <div style="padding: 60px 20px; text-align: center; color: white;">
                <p>âŒ Video yuklanmadi</p>
            </div>
            {% endif %}
        </div>
        <h4 style="color: #2c3e50; font-size: 16px; font-weight: 600; margin-bottom: 8px;">{{ video.title }}</h4>
        <p style="color: #6c757d; margin-bottom: 12px; font-size: 13px; line-height: 1.5;">{{ video.description|truncatewords:15 }}</p>
        <div style="display: flex; justify-content: space-between; align-items: center; padding-top: 12px; border-top: 1px solid #f1f3f5;">
            <span style="color: #adb5bd; font-size: 12px;">ğŸ‘¨â€ğŸ« {{ video.teacher.username }}</span>
            <span style="color: #adb5bd; font-size: 12px;">{{ video.created_at|date:"d.m.Y" }}</span>
        </div>
        
        {% if user.userprofile.user_type == 'teacher' and video.teacher == user %}
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 12px;">
            <a href="{% url 'edit_video' video.id %}" class="btn btn-warning" style="text-align: center; font-size: 13px; padding: 8px;">
                âœï¸ Tahrirlash
            </a>
            <a href="{% url 'delete_video' video.id %}" class="btn btn-danger" style="text-align: center; font-size: 13px; padding: 8px;">
                ğŸ—‘ï¸ O'chirish
            </a>
        </div>
        {% else %}
        <a href="{% url 'watch_video' video.id %}" class="btn btn-primary" style="width: 100%; text-align: center; margin-top: 12px; font-size: 14px;">
            â–¶ï¸ To'liq Ko'rish
        </a>
        {% endif %}
    </div>
    {% endfor %}
</div>
{% else %}
<div class="card" style="text-align: center; padding: 60px 20px; background: linear-gradient(135deg, #f8f9fa 0%, #fff 100%);">
    <div style="font-size: 64px; margin-bottom: 16px; opacity: 0.3;">ğŸ¥</div>
    <h4 style="color: #6c757d; font-size: 16px; font-weight: 500; margin-bottom: 12px;">Hali video darslar yo'q</h4>
    {% if user.userprofile.user_type == 'teacher' %}
    <p style="color: #adb5bd; margin-bottom: 24px; font-size: 14px;">Birinchi video darsni qo'shing!</p>
    <a href="{% url 'create_video' %}" class="btn btn-success">â• Video Qo'shish</a>
    {% else %}
    <p style="color: #adb5bd; font-size: 14px;">O'qituvchilar video qo'shganda bu yerda ko'rinadi</p>
    {% endif %}
</div>
{% endif %}
{% endblock %}
